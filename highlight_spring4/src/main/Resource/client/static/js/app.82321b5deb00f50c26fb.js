webpackJsonp([1],{"0+XJ":function(t,e){},"1uAS":function(t,e){},Bn3m:function(t,e){},CiGF:function(t,e){},Drfx:function(t,e){},EN6S:function(t,e){},KFZf:function(t,e){},MsfI:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={};s.d(i,"filterNum",function(){return T});var n=s("ZLEe"),a=s.n(n),r=(s("ekBL"),s("0+XJ"),s("ggf6")),o=s.n(r),c=(s("EN6S"),s("UySM")),u=s.n(c),d=(s("MsfI"),s("zMIa")),l=s.n(d),v=s("MVMM"),f={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("keep-alive",[this.$route.meta.keepAlive?e("router-view"):this._e()],1),this._v(" "),this.$route.meta.keepAlive?this._e():e("router-view")],1)},staticRenderFns:[]};var p=s("Z0/y")(null,f,!1,function(t){s("KFZf")},null,null).exports,m=s("zO6J"),h=s("3cXf"),g=s.n(h),C={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"steper"},[s("div",{staticClass:"step"},[t.pioneerNum?s("button",{staticClass:"minus el-icon-remove",on:{click:t.useMinus}}):t._e(),t._v(" "),t.pioneerNum?s("span",[t._v(t._s(t.pioneerNum))]):t._e(),t._v(" "),s("button",{staticClass:"plus el-icon-circle-plus",on:{click:t.usePlus}})])])},staticRenderFns:[]};var $=s("Z0/y")({name:"operater",props:["selectData","pioneerNum"],methods:{useMinus:function(){this.pioneerNum>0&&this.$store.commit("decNum",this.selectData)},usePlus:function(){this.$store.commit("incNum",this.selectData)}},watch:{pioneerNum:function(t){return t}}},C,!1,function(t){s("iCSn")},"data-v-1660d556",null).exports,k={name:"cart",data:function(){return{isActive:0}},computed:{cartData:function(){return this.$store.getters.cartList},totalNum:function(){return this.$store.getters.totalNum},totalFee:function(){return this.$store.getters.totalFee},deskNum:function(){return this.$store.getters.deskNum}},methods:{getOrderList:function(t){0!=this.cartData.length?this.isActive=t:this.isActive=0},clearList:function(){this.$store.commit("clear")},goOrder:function(){var t=this;if(0!=this.totalNum){var e=this.$Loading.service({fullscreen:!0}),s={deskId:this.deskNum,orderList:this.cartData,totalNum:this.totalNum,totalFee:this.totalFee};t.$ajax.post(t.$ajaxUrl.cart,g()(s)).then(function(s){if(t.$nextTick(function(){e.close()}),s&&s.data){var i=s.data;i&&1==i.code&&i.data&&i.data.no&&(t.$store.commit("orderData",i.data),t.$router.push({name:"order",params:{deskId:t.deskNum}}))}}).catch(function(s){t.$nextTick(function(){e.close()})})}else alert("请先点餐")}},components:{Operater:$}},L={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cart"},[s("div",{staticClass:"scart"},[s("div",{staticClass:"icon",on:{click:function(e){t.getOrderList("1")}}}),t._v(" "),s("div",{staticClass:"total"},[t.totalNum?t._e():s("div",{staticClass:"not"},[t._v("未选购商品")]),t._v(" "),t.totalNum?s("div",{staticClass:"has"},[s("p",[t._v("订单数量："+t._s(t.totalNum))]),t._v(" "),s("p",[t._v("总金额："),s("span",[t._v("¥"+t._s(t.totalFee))])])]):t._e()]),t._v(" "),s("div",{staticClass:"btn",on:{click:t.goOrder}},[t._v("下单")])]),t._v(" "),s("div",{staticClass:"mask",class:{on:1==t.isActive},on:{click:function(e){t.getOrderList("0")}}}),t._v(" "),s("div",{staticClass:"orderlist",class:{on:1==t.isActive}},[s("div",{staticClass:"title"},[t._v("购物车"),s("span",{staticClass:"del",on:{click:t.clearList}})]),t._v(" "),s("ul",t._l(t.cartData,function(e,i){return s("li",{key:i},[s("div",{staticClass:"name"},[t._v(t._s(e.food_name))]),t._v(" "),s("div",{staticClass:"price"},[t._v("¥"+t._s(e.food_price))]),t._v(" "),s("operater",{attrs:{selectData:e,pioneerNum:e.num}})],1)}))])])},staticRenderFns:[]};var N=s("Z0/y")(k,L,!1,function(t){s("Bn3m")},"data-v-2f256311",null).exports,y=(s("CiGF"),s("s9Gd")),x={name:"popup",props:["popupId"],data:function(){return{bannerList:["http://via.placeholder.com/340x200","http://via.placeholder.com/340x200","http://via.placeholder.com/340x200"]}},methods:{getPopup:function(){this.$root.$emit("change-popup",0)}},computed:{pioneerList:function(){return this.$store.state.orderList}},components:{Swipe:y.Swipe,SwipeItem:y.SwipeItem,Operater:$}},w={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"popup"},[s("div",{staticClass:"mask",on:{click:t.getPopup}}),t._v(" "),s("div",{staticClass:"layer"},[s("div",{staticClass:"swipe-wrapper"},[s("swipe",{staticClass:"my-swipe",attrs:{defaultIndex:t.popupId-1,auto:0}},t._l(t.pioneerList,function(e,i){return s("swipe-item",{key:i,staticClass:"swipe-item",style:{backgroundImage:"url(/image/"+e.food_imgid+")"}},[s("h3",[t._v(t._s(e.food_name))]),t._v(" "),s("div",{staticClass:"info"},[s("div",{staticClass:"price"},[s("p",[t._v("¥"+t._s(e.food_price))])]),t._v(" "),s("operater",{attrs:{selectData:e,pioneerNum:e.num}}),t._v(" "),s("div",{staticClass:"detail"},[t._v("\n              "+t._s(e.food_desc)+"\n          ")])],1)])}))],1)])])},staticRenderFns:[]};var D={name:"menus",data:function(){return{deskId:this.$route.params.deskId,showPopup:0,activeId:0,categoryList:[],categoryid:0}},created:function(){},beforeMount:function(){var t=this;document.title="下单";var e=this,s=this.$Loading.service({fullscreen:!0});e.$ajax.get(e.$ajaxUrl.menus).then(function(t){if(e.$nextTick(function(){s.close()}),t&&t.data){var i=t.data;i&&0==i.code&&(e.categoryList=i.data,e.categoryid=_.first(i.data).menu_id,e.$store.commit("init",i.data),e.$store.commit("initId",e.deskId))}}).catch(function(t){console.log(t),e.$nextTick(function(){s.close()})}),this.$root.$on("change-popup",function(e){t.showPopup=e})},computed:{pioneerList:function(){return this.$store.state.orderList}},methods:{getpioneer:function(t,e){this.categoryid=t,this.activeId=e},getPopup:function(t){this.showPopup=++t}},components:{Cart:N,Popup:s("Z0/y")(x,w,!1,function(t){s("ula4"),s("Drfx")},"data-v-13f641ce",null).exports,Operater:$}},I={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"menus"},[s("div",{staticClass:"header"},[t._v("您的桌号是: "+t._s(t.deskId))]),t._v(" "),s("div",{staticClass:"list"},[s("div",{staticClass:"left"},[s("ul",{staticClass:"category"},t._l(t.categoryList,function(e,i){return s("li",{key:i,class:{on:i==t.activeId},on:{click:function(s){t.getpioneer(e.menu_id,i)}}},[t._v(t._s(e.menu_name))])}))]),t._v(" "),s("div",{staticClass:"right"},[s("ul",{staticClass:"pioneer"},t._l(t.pioneerList,function(e,i){return s("li",{directives:[{name:"show",rawName:"v-show",value:e.menu_id==t.categoryid,expression:"pioneer.menu_id == categoryid"}],key:e.menu_id+"_"+e.food_id},[s("img",{attrs:{src:"/image/"+e.food_imgid},on:{click:function(e){t.getPopup(i)}}}),t._v(" "),s("div",{staticClass:"intro"},[s("h3",[t._v(t._s(e.food_name))]),t._v(" "),s("p",{staticClass:"price"},[s("span",[t._v("¥"+t._s(e.food_price))]),t._v("／份")])]),t._v(" "),s("operater",{attrs:{selectData:e,pioneerNum:e.num}})],1)}))])]),t._v(" "),s("cart"),t._v(" "),t.showPopup?s("popup",{attrs:{popupId:t.showPopup}}):t._e()],1)},staticRenderFns:[]};var F=s("Z0/y")(D,I,!1,function(t){s("P+wU")},"data-v-0fd386fa",null).exports,E={name:"order",beforeMount:function(){document.title="订单详情"},computed:{cartData:function(){return this.$store.getters.cartList},totalNum:function(){return this.$store.getters.totalNum},totalFee:function(){return this.$store.getters.totalFee},deskNum:function(){return this.$store.getters.deskNum},getOrderData:function(){return this.$store.getters.orderData}},methods:{cancel:function(){var t=this;t.$ajax.post(t.$ajaxUrl.cancel,g()({no:t.getOrderData.no})).then(function(e){if(e&&e.data){var s=e.data;s&&1==s.code?(t.$message({type:"success",message:"删除成功!"}),setTimeout(function(){t.$store.commit("clear"),t.$router.go(-1)},1e3)):t.$message({type:"error",message:"删除失败，请重试!"})}}).catch(function(t){})},success:function(){this.$ajax.post("/pioneer/order/pay",{deskId:"1"}).then(function(t){console.log(t)}).catch(function(t){}),this.$message({type:"success",message:"ok!"})},open2:function(){var t=this;this.$confirm("此操作将删除该订单, 是否继续?","提示",{showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){t.cancel()}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}},b={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order"},[s("div",{staticClass:"header"},[s("div",{staticClass:"hid"},[s("p",[t._v("您的桌号是:"+t._s(t.deskNum))]),t._v(" "),s("p",[t._v("您的订单号是："+t._s(t.getOrderData.no))]),t._v(" "),s("p",[t._v(t._s(t.getOrderData.time))])])]),t._v(" "),s("div",{staticClass:"card"},[s("div",{staticClass:"food"},[t._m(0),t._v(" "),s("ul",t._l(t.cartData,function(e,i){return s("li",{key:i},[s("div",{staticClass:"f1"},[t._v(t._s(e.food_name))]),t._v(" "),s("div",{staticClass:"f2"},[t._v(t._s(e.num))]),t._v(" "),s("div",{staticClass:"f3"},[t._v("￥"+t._s(e.food_price))])])}))]),t._v(" "),s("ul",{staticClass:"tinfo"},[s("li",[s("div",{staticClass:"left"},[t._v("总数量")]),t._v(" "),s("div",{staticClass:"right"},[t._v(t._s(t.totalNum))])]),t._v(" "),s("li",[s("div",{staticClass:"left"},[t._v("桌号")]),t._v(" "),s("div",{staticClass:"right"},[t._v(t._s(t.deskNum))])]),t._v(" "),t._m(1),t._v(" "),s("li",[s("div",{staticClass:"left"},[t._v("订单金额")]),t._v(" "),s("div",{staticClass:"right"},[t._v("￥"+t._s(t.totalFee))])]),t._v(" "),s("li",[s("div",{staticClass:"left"},[t._v("实付金额")]),t._v(" "),s("div",{staticClass:"right red"},[t._v("￥"+t._s(t.totalFee))])]),t._v(" "),t._m(2)])]),t._v(" "),s("div",{staticClass:"bottom"},[s("div",{staticClass:"btn",on:{click:t.success}},[t._v("付款")]),t._v(" "),s("div",{staticClass:"btn",on:{click:t.open2}},[t._v("取消")]),t._v(" "),s("div",{staticClass:"btn b2",on:{click:t.success}},[t._v("确定")])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("div",{staticClass:"f1"},[this._v("商品")]),this._v(" "),e("div",{staticClass:"f2"},[this._v("数量")]),this._v(" "),e("div",{staticClass:"f3"},[this._v("金额")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("div",{staticClass:"left"},[this._v("支付方式")]),this._v(" "),e("div",{staticClass:"right"},[this._v("等待支付")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("div",{staticClass:"left"},[this._v("备注")]),this._v(" "),e("div",{staticClass:"right"})])}]};var O=s("Z0/y")(E,b,!1,function(t){s("1uAS")},"data-v-6e85e776",null).exports;v.default.use(m.a);var P=new m.a({scrollBehavior:function(t,e,s){return s||{x:0,y:0}},base:"/client/",routes:[{path:"/",redirect:"/shop/1/menus"},{path:"/shop/:deskId/menus",component:F,name:"menus",meta:{keepAlive:!0}},{path:"/shop/:deskId/order",component:O,name:"order",meta:{keepAlive:!1}}]}),M=s("9rMa"),A=s("Y0Uy"),S=s.n(A);v.default.use(M.a);var j=new M.a.Store({state:{orderList:[],deskNum:"",orderData:{}},mutations:{init:function(t,e){var s=[];e.forEach(function(t){t.foods.forEach(function(e){e.menu_id=t.menu_id,s.push(e)})}),t.orderList=s},initId:function(t,e){t.deskNum=e},incNum:function(t,e){var s=S.a.findIndex(t.orderList,function(t){return t.food_id==e.food_id});-1!=s&&(t.orderList[s].num?t.orderList[s].num++:t.orderList[s].num=1);t.orderList=S.a.filter(t.orderList,function(){return!0})},decNum:function(t,e){var s=S.a.findIndex(t.orderList,function(t){return t.food_id==e.food_id});-1!=s&&t.orderList[s].num--,t.orderList=S.a.filter(t.orderList,function(){return!0})},orderData:function(t,e){t.orderData.no=e.no,t.orderData.time=e.time},clear:function(t){var e=[];S.a.forEach(t.orderList,function(t){t.num&&(t.num=0),e.push(t)}),t.orderList=e}},getters:{deskNum:function(t){return t.deskNum},cartList:function(t){return S.a.filter(t.orderList,"num")},totalNum:function(t){var e=0;return S.a.forEach(t.orderList,function(t){t.num&&(e+=t.num)}),e},totalFee:function(t){var e=0;return S.a.forEach(t.orderList,function(t){t.num&&(e+=t.food_price*t.num)}),e.toFixed(2)},detailData:function(t){return function(e){return S.a.find(t.orderList,function(t){return t.food_id==e})}},orderData:function(t){return t.orderData}}}),Z=s("aozt"),B=s.n(Z);function T(t){return t>0?t:0}v.default.config.productionTip=!1,v.default.use(l.a),v.default.prototype.$ajax=B.a,v.default.prototype.$ajaxUrl={menus:"/pioneer/v1/queryMenuFoots",cart:"/pioneer/order/genderOrder",cancel:"/pioneer/order/cancel"},v.default.prototype.$Loading=u.a,v.default.prototype.$confirm=o.a,v.default.prototype.$message=o.a,a()(i).forEach(function(t){v.default.filter(t,i[t])}),new v.default({el:"#app",template:"<App/>",components:{App:p},router:P,store:j})},"P+wU":function(t,e){},ekBL:function(t,e){},iCSn:function(t,e){},ula4:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.82321b5deb00f50c26fb.js.map